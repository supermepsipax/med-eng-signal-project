
    
=== PROCESSING LOG ===
--- Sleep Scoring Pipeline - Iteration 1 ---

=== STEP 1: DATA LOADING ===
Found 10 data files to load

Loading R1...
Loading training data from data/training/R1.edf and data/training/R1.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1083 epochs (9.03 hours)
Sleep stage distribution:
  Wake: 333 epochs (30.7%)
  N1: 47 epochs (4.3%)
  N2: 457 epochs (42.2%)
  N3: 145 epochs (13.4%)
  REM: 102 epochs (9.4%)
  Multi-channel data loaded:
    EEG: (1083, 2, 3750)
    EOG: (1083, 2, 3750)
    EMG: (1083, 1, 3750)
  Labels: (1083,)
  Using EEG channel 1: (1083, 3750)

Loading R10...
Loading training data from data/training/R10.edf and data/training/R10.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1083 epochs (9.03 hours)
Sleep stage distribution:
  Wake: 251 epochs (23.2%)
  N1: 11 epochs (1.0%)
  N2: 491 epochs (45.3%)
  N3: 163 epochs (15.0%)
  REM: 168 epochs (15.5%)
  Multi-channel data loaded:
    EEG: (1083, 2, 3750)
    EOG: (1083, 2, 3750)
    EMG: (1083, 1, 3750)
  Labels: (1083,)
  Using EEG channel 1: (1083, 3750)

Loading R2...
Loading training data from data/training/R2.edf and data/training/R2.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1078 epochs (8.98 hours)
Sleep stage distribution:
  Wake: 716 epochs (66.4%)
  N1: 3 epochs (0.3%)
  N2: 238 epochs (22.1%)
  N3: 61 epochs (5.7%)
  REM: 61 epochs (5.7%)
  Multi-channel data loaded:
    EEG: (1078, 2, 3750)
    EOG: (1078, 2, 3750)
    EMG: (1078, 1, 3750)
  Labels: (1078,)
  Using EEG channel 1: (1078, 3750)

Loading R3...
Loading training data from data/training/R3.edf and data/training/R3.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1048 epochs (8.73 hours)
Sleep stage distribution:
  Wake: 332 epochs (31.6%)
  N1: 35 epochs (3.3%)
  N2: 289 epochs (27.6%)
  N3: 307 epochs (29.3%)
  REM: 86 epochs (8.2%)
  Multi-channel data loaded:
    EEG: (1048, 2, 3750)
    EOG: (1048, 2, 3750)
    EMG: (1048, 1, 3750)
  Labels: (1048,)
  Using EEG channel 1: (1048, 3750)

Loading R4...
Loading training data from data/training/R4.edf and data/training/R4.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 874 epochs (7.28 hours)
Sleep stage distribution:
  Wake: 273 epochs (31.2%)
  N1: 18 epochs (2.1%)
  N2: 177 epochs (20.2%)
  N3: 315 epochs (36.0%)
  REM: 92 epochs (10.5%)
  Multi-channel data loaded:
    EEG: (874, 2, 3750)
    EOG: (874, 2, 3750)
    EMG: (874, 1, 3750)
  Labels: (874,)
  Using EEG channel 1: (874, 3750)

Loading R5...
Loading training data from data/training/R5.edf and data/training/R5.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1083 epochs (9.03 hours)
Sleep stage distribution:
  Wake: 344 epochs (31.7%)
  N1: 42 epochs (3.9%)
  N2: 508 epochs (46.9%)
  N3: 99 epochs (9.1%)
  REM: 91 epochs (8.4%)
  Multi-channel data loaded:
    EEG: (1083, 2, 3750)
    EOG: (1083, 2, 3750)
    EMG: (1083, 1, 3750)
  Labels: (1083,)
  Using EEG channel 1: (1083, 3750)

Loading R6...
Loading training data from data/training/R6.edf and data/training/R6.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1083 epochs (9.03 hours)
Sleep stage distribution:
  Wake: 310 epochs (28.6%)
  N1: 48 epochs (4.4%)
  N2: 529 epochs (48.8%)
  N3: 39 epochs (3.6%)
  REM: 158 epochs (14.6%)
  Multi-channel data loaded:
    EEG: (1083, 2, 3750)
    EOG: (1083, 2, 3750)
    EMG: (1083, 1, 3750)
  Labels: (1083,)
  Using EEG channel 1: (1083, 3750)

Loading R7...
Loading training data from data/training/R7.edf and data/training/R7.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 918 epochs (7.65 hours)
Sleep stage distribution:
  Wake: 254 epochs (27.6%)
  N1: 18 epochs (2.0%)
  N2: 459 epochs (49.9%)
  N3: 40 epochs (4.4%)
  REM: 148 epochs (16.1%)
  Multi-channel data loaded:
    EEG: (918, 2, 3750)
    EOG: (918, 2, 3750)
    EMG: (918, 1, 3750)
  Labels: (918,)
  Using EEG channel 1: (918, 3750)

Loading R8...
Loading training data from data/training/R8.edf and data/training/R8.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 958 epochs (7.98 hours)
Sleep stage distribution:
  Wake: 288 epochs (30.0%)
  N1: 15 epochs (1.6%)
  N2: 362 epochs (37.7%)
  N3: 213 epochs (22.2%)
  REM: 81 epochs (8.4%)
  Multi-channel data loaded:
    EEG: (958, 2, 3750)
    EOG: (958, 2, 3750)
    EMG: (958, 1, 3750)
  Labels: (958,)
  Using EEG channel 1: (958, 3750)

Loading R9...
Loading training data from data/training/R9.edf and data/training/R9.xml...
Identified channels:
  EEG: ['EEG(sec)', 'EEG']
  EOG: ['EOG(L)', 'EOG(R)']
  EMG: ['EMG']
  EEG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EOG: 2 channels, 3750 samples/epoch, 125.0 Hz
  EMG: 1 channels, 3750 samples/epoch, 125.0 Hz

Loaded 1085 epochs (9.04 hours)
Sleep stage distribution:
  Wake: 383 epochs (35.3%)
  N1: 38 epochs (3.5%)
  N2: 298 epochs (27.4%)
  N3: 236 epochs (21.7%)
  REM: 131 epochs (12.1%)
  Multi-channel data loaded:
    EEG: (1085, 2, 3750)
    EOG: (1085, 2, 3750)
    EMG: (1085, 1, 3750)
  Labels: (1085,)
  Using EEG channel 1: (1085, 3750)

--- Concatenating data from 10 files ---
Combined dataset:
  EEG data shape: (10293, 3750)
  Labels shape: (10293,)
  Total epochs: 10293

Class distribution across all files:
  Wake: 3474 epochs (33.8%)
  N1: 275 epochs (2.7%)
  N2: 3808 epochs (37.0%)
  N3: 1618 epochs (15.7%)
  REM: 1118 epochs (10.9%)

=== STEP 2: PREPROCESSING ===
Preprocessing data for iteration 1...
Processing single-channel data (backward compatibility)
Preprocessed data shape: (10293, 3750)

=== STEP 3: FEATURE EXTRACTION ===
Extracting features for iteration 1...
Processing single-channel data (backward compatibility)
WARNING: Only 16 features extracted, target is 16 for iteration 1
Students must implement the remaining time-domain features!
Extracted features shape: (10293, 16)

=== STEP 4: FEATURE SELECTION ===
Selecting features for iteration 1...
Input features shape: (10293, 16)
Early iteration - using all available features
Selected features shape: (10293, 16)
Selected features shape: (10293, 16)

=== STEP 5: CLASSIFICATION ===
Training knn classifier...
Features shape: (10293, 16), Labels shape: (10293,)
Using k-NN with k=5

Performing 5-fold stratified cross-validation...
(Stratified to maintain class balance in each fold)

Cross-Validation Results:
--------------------------------------------------
Fold 1/5: Accuracy=0.606, Macro F1=0.419
Fold 2/5: Accuracy=0.606, Macro F1=0.425
Fold 3/5: Accuracy=0.606, Macro F1=0.427
Fold 4/5: Accuracy=0.617, Macro F1=0.432
Fold 5/5: Accuracy=0.612, Macro F1=0.423
--------------------------------------------------

Cross-Validation Summary:
Mean Accuracy: 0.609 (+/- 0.004)
Mean Macro F1-Score: 0.425 (+/- 0.004)
Accuracy Range: [0.606, 0.617]

Comprehensive Performance Metrics (Across All CV Folds):

======================================================================
SLEEP STAGE CLASSIFICATION PERFORMANCE METRICS
======================================================================
Overall Accuracy: 0.609
Macro F1-Score: 0.425
Weighted F1-Score: 0.587

Confusion Matrix:
      Wake  N1    N2    N3  REM
Wake  2493  15   773    92  101
N1     115   1   134    10   15
N2     524  18  2630   461  175
N3      32   3   545  1024   14
REM    255  12   628   100  123

Per-Class Performance Metrics:
----------------------------------------------------------------------
Stage    Accuracy   Sensitivity  Specificity  F1-Score  
----------------------------------------------------------------------
Wake     0.718      0.718        0.864        0.723     
N1       0.004      0.004        0.995        0.006     
N2       0.691      0.691        0.679        0.618     
N3       0.633      0.633        0.924        0.620     
REM      0.110      0.110        0.967        0.159     
----------------------------------------------------------------------

Class Distribution in Test Set:
Wake: 3474 samples (33.8%)
N1: 275 samples (2.7%)
N2: 3808 samples (37.0%)
N3: 1618 samples (15.7%)
REM: 1118 samples (10.9%)

Notes for Sleep Scoring:
- Sensitivity = Recall = True Positive Rate (correctly identified stages)
- Specificity = True Negative Rate (correctly rejected stages)
- Sleep stage imbalance is natural (more N2, less N1/REM)
- Consider Cohen's kappa for chance-corrected agreement
- Clinical focus: High sensitivity for REM and N3 stages

======================================================================
Training final model on all available data...
======================================================================
Final model training complete!

TODO: Students should add Cohen's kappa and ROC-AUC metrics
Trained knn classifier

=== STEP 6: VISUALIZATION ===
Visualizing results...

=== STEP 7: PROCESSING LOG & REPORT GENERATION ===



    # Sleep Scoring Report - Iteration 1

    ## Model
    KNeighborsClassifier

    ## Performance
    Accuracy: ...
    Kappa: ...
    F1-score: ...

    ## Notes
    This is a dummy report. Implement full report generation.
    